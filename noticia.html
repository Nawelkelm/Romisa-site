<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Meta tags dinámicos - se actualizarán con JS -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" id="meta-description" content="Noticia de ROMISA - Rodamientos Misiones Sociedad Anónima"/>
    <meta name="keywords" content="romisa, noticias, blog, industrial, posadas, misiones"/>
    
    <!-- CSS del sitio + FontAwesome para Iconos -->
    <link rel="stylesheet" href="./assets/css/custom.css" />
    <link rel="stylesheet" href="./assets/css/responsive.css">
    <link rel="stylesheet" href="./assets/css/noticias.css" />
    <link rel="stylesheet" href="./assets/css/loader.css" />
    <link rel="stylesheet" href="./assets/css/whatsapp-enhanced.css" />
    <link rel="stylesheet" href="./assets/css/whatsapp-popup-fix.css" />
    <script src="https://kit.fontawesome.com/a5c59cf2a1.js" crossorigin="anonymous"></script>

    <!-- Iconos Favicon -->
    <link rel="shortcut icon" href="assets/img/android-chrome-256x256.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
    <link rel="manifest" href="site.webmanifest" />
    <link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />

    <!-- jQuery, Bootstrap CSS, Superfish & Hover-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"/>
    <link rel="stylesheet" href="./assets/css/hover.css" />
    <link rel="stylesheet" href="./assets/plugins/superfish/css/superfish.css" />
    <script src="./assets/plugins/superfish/hoverIntent.js"></script>
    <script src="./assets/plugins/superfish/superfish.min.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet"/>

    <title id="page-title">Noticia - RO.MI.SA</title>
</head>
<body>
    <!-- Loader -->
    <div id="contenedor_carga"></div>
    <div id="carga"></div>

    <!-- Botón Float recordatorio -->
    <a href="https://ecommerce.romisa.com.ar/new/public/productos.php" data-page-id="224234906" class="btn-flotante ocultar" id="ocultar" target="_blank">INGRESA A NUESTRA TIENDA VIRTUAL</a>
    
    <!-- Botón Float WhatsApp -->
    <a href="https://api.whatsapp.com/send?phone=5493764280451&text=Hola!!!,%20necesito%20consultar%20sobre%20sus%20productos:%20" class="whatsapp-float" target="_blank" id="hiddenWhatsapp">
        <i class="fa fa-whatsapp my-float"></i>
    </a>

    <!-- Navbar -->
    <div id="navbar-container"></div>

    <script>
        $(document).ready(function() {
            fetch('navbarromisa.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('navbar-container').innerHTML = data;
                    if (typeof jQuery !== 'undefined' && typeof jQuery.fn.superfish !== 'undefined') {
                        $('.sf-menu').superfish({
                            animation: {height: 'show'},
                            delay: 100
                        });
                    }
                });
        });
    </script>

    <!-- Banner -->
    <div class="page-title">
        <p class="page-title-text">NOVEDADES - ROMISA</p>
    </div>

    <!-- Loading State -->
    <div id="loading-noticia" class="loading">
        <i class="fas fa-spinner"></i>
        <p>Cargando noticia...</p>
    </div>

    <!-- Contenedor de Noticia -->
    <div id="noticia-detalle-container" class="noticia-detalle" style="display: none;">
        <!-- El contenido se cargará dinámicamente aquí -->
    </div>

    <!-- Error State -->
    <div id="error-noticia" class="no-noticias" style="display: none;">
        <i class="fas fa-exclamation-triangle"></i>
        <p>No se pudo cargar la noticia solicitada.</p>
        <a href="novedades.html" class="noticia-detalle-volver" style="display: inline-flex; margin-top: 20px;">
            <i class="fas fa-arrow-left"></i> Volver a Novedades
        </a>
    </div>

    <!-- Modal para ver imagen en tamaño completo -->
    <div id="modal-imagen-galeria" class="modal-imagen-galeria" style="display: none;" onclick="cerrarImagenGaleria()">
        <span class="modal-imagen-close" onclick="cerrarImagenGaleria()">&times;</span>
        <img class="modal-imagen-content" id="imagen-modal-grande">
        <div class="modal-imagen-navegacion">
            <button class="modal-imagen-prev" onclick="event.stopPropagation(); navegarGaleria(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="modal-imagen-next" onclick="event.stopPropagation(); navegarGaleria(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        <div id="modal-imagen-caption" class="modal-imagen-caption"></div>
    </div>

    <!-- Banner Area Clientes -->
    <div class="container-fluid" style="background-color: #f6f6f6; height: 130px;">
        <div class="container">
            <div class="clients-area">
                <div class="row">
                    <div class="col-lg-12 col-sm-12">
                        <p class="clients-area-text">INGRESO CLIENTES</p>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="clients-area-btn">
                        <a href="https://ecommerce.romisa.com.ar/public/login.php" target="_blank" class="btn btn-dark">INICIAR SESIÓN</a>
                        <a href="https://ecommerce.romisa.com.ar/public/contactenos.php" target="_blank" class="btn btn-secondary">¿NO SOS CLIENTE?</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container-fluid footer-container">
            <div class="row">
                <div class="col col-lg-3 mt-3" style="border-right: 1px solid #7D8588;">
                    <img src="./assets/img/romisa-logo-original.png" width="200" height="35" alt=""/>
                    <div class="row">
                        <div class="col-lg-12">
                            <p class="footerSecondaryText">Somos una empresa que tiene como objetivo satisfacer las necesidades y expectativas de las industrias de la región, brindando a nuestros clientes amplia gama de productos, sólido asesoramiento técnico y el respaldo de una trayectoria de más de 25 años de constante trabajo y crecimiento.</p>
                        </div>
                    </div>
                </div>
                <div class="col col-md-3 col-12 mt-3">
                    <p class="footerMainText">Newsletter</p>
                    <div class="row">
                        <div class="col-lg-12">
                            <p class="footerContactText">Suscríbase a nuestro portal de noticias y reciba las últimas novedades en productos.</p>
                        </div>
                    </div>
                    <div class="row">
                        <form onsubmit="return doSubscribe();">
                            <div class="mb-3">
                                <input type="email" id="subscriberEmail" class="newsletter-control" placeholder="E-mail" required>
                            </div>
                            <div class="mb-3">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-primaryg">Suscribirse</button>
                                    <p id="subscribe-message"></p>
                                </span>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="col col-lg-3 mt-3 text-end" style="border-right: 1px solid #7D8588;">
                    <p class="footerMainText">Navegación</p>
                    <p class="footerSubLinks"><a href="index.html">INICIO</a></p>
                    <p class="footerSubLinks"><a href="nosotros.html">QUIÉNES SOMOS</a></p>
                    <p class="footerSubLinks"><a href="divisiones.html">DIVISIONES</a></p>
                    <p class="footerSubLinks"><a href="contacto.html">CONTACTO</a></p>
                    <p class="footerSubLinks"><a href="novedades.html">NOVEDADES</a></p>
                </div>
                <div class="col col-lg-3 mt-3">
                    <p class="footerMainText">Contacto</p>
                    <div class="row">
                        <div class="col-12">
                            <p class="footerContactText"><i class="fas fa-map-marker-alt" style="color: #000000"></i> Av. Francisco de Haro 4447, Posadas, Misiones, 3300, Argentina</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <p class="footerContactText"><i class="fas fa-envelope" style="color: #000000"></i> ventas@romisa.com.ar</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <p class="footerContactText"><i class="fas fa-phone" style="color: #000000"></i> +54 (3764) 457900 Líneas Rotativas</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="footer-social-media">
                            <div class="col-lg-2">
                                <a href="https://www.facebook.com/romisaferreteriaindustrial"><i class="fab fa-facebook-f fa-lg" style="color: #000000"></i></a>
                            </div>
                            <div class="col-lg-2">
                                <a href="https://www.instagram.com/romisaferreteriaindustrial"><i class="fab fa-instagram fa-lg" style="color: #000000"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bottom-footer">
                    <p class="bottom-footer-text">&copy; ROMISA - Todos los derechos reservados.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap Bundle Javascript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    
    <!-- Scripts de la Página -->
    <script src="./assets/plugins/superfish/superfish.js"></script>
    <script src="./assets/js/sticky-header.js"></script>
    <script src="./assets/js/hideContactButton.js"></script>
    <script src="./assets/js/hideWhatsapp.js"></script>
    <script src="assets/js/buttonEffect.js"></script>

    <!-- Script del Loader -->
    <script>
        window.onload = function() {
            var contenedor = document.getElementById('contenedor_carga');
            var conteiner = document.getElementById('carga');
            contenedor.style.visibility = 'hidden';
            contenedor.style.opacity = '0';
            conteiner.style.visibility = 'hidden';
            conteiner.style.opacity = '0';
        }
    </script>

    <!-- Superfish -->
    <script>
        jQuery(document).ready(function() {
            jQuery('ul.sf-menu').superfish();
        });
    </script>

    <!-- Script para cargar noticia -->
    <script>
        // Obtener ID de la noticia desde URL
        function obtenerIdNoticia() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('id');
        }

        // Función para formatear fecha
        function formatearFecha(fecha) {
            const opciones = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
            return new Date(fecha).toLocaleDateString('es-AR', opciones);
        }

        // Función para cargar la noticia
        function cargarNoticia() {
            const noticiaId = obtenerIdNoticia();

            if (!noticiaId) {
                mostrarError();
                return;
            }

            fetch(`api_noticias.php?action=obtener&id=${noticiaId}`)
                .then(response => response.json())
                .then(data => {
                    const loadingDiv = document.getElementById('loading-noticia');
                    const containerDiv = document.getElementById('noticia-detalle-container');
                    const errorDiv = document.getElementById('error-noticia');

                    loadingDiv.style.display = 'none';

                    if (data.success && data.noticia) {
                        const noticia = data.noticia;
                        
                        // Actualizar título de la página y meta tags
                        document.getElementById('page-title').textContent = `${noticia.titulo} - ROMISA`;
                        document.getElementById('meta-description').setAttribute('content', noticia.resumen);

                        // Construir URL actual para compartir
                        const urlActual = window.location.href;
                        const urlCompartir = encodeURIComponent(urlActual);
                        const textoCompartir = encodeURIComponent(noticia.titulo);

                        // Renderizar noticia
                        containerDiv.innerHTML = `
                            <div class="noticia-detalle-header">
                                <h1 class="noticia-detalle-titulo">${noticia.titulo}</h1>
                                <div class="noticia-detalle-meta">
                                    <div class="noticia-detalle-meta-item">
                                        <i class="far fa-calendar-alt"></i>
                                        <span>${formatearFecha(noticia.fecha_publicacion)}</span>
                                    </div>
                                    <div class="noticia-detalle-meta-item">
                                        <i class="far fa-user"></i>
                                        <span>${noticia.autor}</span>
                                    </div>
                                    <div class="noticia-detalle-meta-item">
                                        <i class="far fa-eye"></i>
                                        <span>${noticia.vistas} visualizaciones</span>
                                    </div>
                                </div>
                            </div>

                            ${noticia.imagen ? `
                                <div class="noticia-detalle-imagen">
                                    <img src="${noticia.imagen}" alt="${noticia.titulo}" onerror="this.style.display='none'">
                                </div>
                            ` : ''}

                            <div class="noticia-detalle-contenido">
                                ${noticia.contenido}
                            </div>

                            ${noticia.galeria && noticia.galeria.length > 0 ? `
                                <div class="noticia-galeria">
                                    <h3 class="noticia-galeria-titulo">
                                        <i class="fas fa-images"></i> Galería de Imágenes
                                    </h3>
                                    <div class="noticia-galeria-grid">
                                        ${noticia.galeria.map((img, index) => `
                                            <div class="noticia-galeria-item" onclick="abrirImagenGaleria('${img}', ${index})">
                                                <img src="${img}" alt="Imagen ${index + 1}" loading="lazy">
                                                <div class="noticia-galeria-overlay">
                                                    <i class="fas fa-search-plus"></i>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}

                            <div class="noticia-compartir">
                                <h4>Compartir esta noticia</h4>
                                <div class="noticia-compartir-botones">
                                    <a href="https://www.facebook.com/sharer/sharer.php?u=${urlCompartir}" target="_blank" class="btn-compartir btn-facebook">
                                        <i class="fab fa-facebook-f"></i> Facebook
                                    </a>
                                    <a href="https://twitter.com/intent/tweet?url=${urlCompartir}&text=${textoCompartir}" target="_blank" class="btn-compartir btn-twitter">
                                        <i class="fab fa-twitter"></i> Twitter
                                    </a>
                                    <a href="https://api.whatsapp.com/send?text=${textoCompartir}%20${urlCompartir}" target="_blank" class="btn-compartir btn-whatsapp">
                                        <i class="fab fa-whatsapp"></i> WhatsApp
                                    </a>
                                    <a href="https://www.linkedin.com/sharing/share-offsite/?url=${urlCompartir}" target="_blank" class="btn-compartir btn-linkedin">
                                        <i class="fab fa-linkedin-in"></i> LinkedIn
                                    </a>
                                </div>
                            </div>

                            <a href="novedades.html" class="noticia-detalle-volver">
                                <i class="fas fa-arrow-left"></i> Volver a Novedades
                            </a>
                        `;

                        containerDiv.style.display = 'block';
                    } else {
                        mostrarError();
                    }
                })
                .catch(error => {
                    console.error('Error al cargar noticia:', error);
                    mostrarError();
                });
        }

        function mostrarError() {
            document.getElementById('loading-noticia').style.display = 'none';
            document.getElementById('error-noticia').style.display = 'block';
        }

        // Variables para manejar la galería
        let galeriaImagenes = [];
        let indiceActual = 0;

        // Función para abrir imagen en modal
        function abrirImagenGaleria(src, index) {
            galeriaImagenes = Array.from(document.querySelectorAll('.noticia-galeria-item img')).map(img => img.src);
            indiceActual = index;
            mostrarImagenModal();
            document.getElementById('modal-imagen-galeria').style.display = 'block';
            document.body.style.overflow = 'hidden'; // Prevenir scroll
        }

        // Función para cerrar modal
        function cerrarImagenGaleria() {
            document.getElementById('modal-imagen-galeria').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Función para navegar en la galería
        function navegarGaleria(direccion) {
            indiceActual += direccion;
            if (indiceActual < 0) indiceActual = galeriaImagenes.length - 1;
            if (indiceActual >= galeriaImagenes.length) indiceActual = 0;
            mostrarImagenModal();
        }

        // Función para mostrar imagen en el modal
        function mostrarImagenModal() {
            document.getElementById('imagen-modal-grande').src = galeriaImagenes[indiceActual];
            document.getElementById('modal-imagen-caption').textContent = `Imagen ${indiceActual + 1} de ${galeriaImagenes.length}`;
        }

        // Cerrar modal con tecla ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                cerrarImagenGaleria();
            } else if (event.key === 'ArrowLeft') {
                navegarGaleria(-1);
            } else if (event.key === 'ArrowRight') {
                navegarGaleria(1);
            }
        });

        // Cargar noticia al cargar la página
        document.addEventListener('DOMContentLoaded', cargarNoticia);
    </script>
</body>
</html>
